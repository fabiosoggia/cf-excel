webpackJsonp([1,0],[function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var r=o(2),a=n(r),l=o(17),s=n(l);new a["default"]({el:"body",components:{App:s["default"]}})},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function r(e){return"string"!=typeof e?!1:0===e.length?!1:"="===e[0]}function a(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",o=e[0].toUpperCase(),n=e.substring(1),r=1*n-1,a=t.indexOf(o);return{row:r,col:a}}function l(e,t,o){var n=a(t),r=a(o);if(n.row>r.row){var l=n.row;n.row=r.row,r=l}if(n.col>r.col){var s=n.col;n.col=r.col,r=s}for(var c=[],u=n.row;u<=r.row;u++)for(var i=n.col;i<=r.col;i++)c.push(e.cells[u][i]);return c}function s(e,t){var o=/=([^\(]+)\(([^\)]+)\)/gi,n=o.exec(t);try{var r=n[1].toUpperCase(),a=n[2],s=a.split(":"),u=l(e,s[0],s[1]),i=u.length;if("SUM"===r){for(var f=0,d=0;i>d;d++){var p=u[d];f+=1*c(e,p.row,p.col)}return f}if("MAX"===r){for(var v=Number.NEGATIVE_INFINITY,b=0;i>b;b++){var _=u[b],h=1*c(e,_.row,_.col);h>v&&(v=h)}return v}if("MIN"===r){for(var x=Number.POSITIVE_INFINITY,m=0;i>m;m++){var w=u[m],g=1*c(e,w.row,w.col);x>g&&(x=g)}return x}if("AVERAGE"===r){for(var y=0,M=0;i>M;M++){var N=u[M];y+=1*c(e,N.row,N.col)}var A=y/i;return A}return"UNDEF"}catch(I){return"err"}}function c(e,t,o){var n=e.cells[t][o].content,a=r(n);return a?s(e,n):e.cells[t][o].content}function u(e){var t=e.row+"_"+e.col,o="/cells/"+t;b.database().ref(o).set(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isFormula=r,t.getValue=c,t.save=u;var i=o(10),f=n(i),d=o(12),p=n(d),v={apiKey:"AIzaSyCV75QBr8hleUZ2rQ-uOx1NyE8q2Rn1uXo",authDomain:"cf-excel.firebaseapp.com",databaseURL:"https://cf-excel.firebaseio.com",storageBucket:""},b=f["default"].initializeApp(v),_={cells:[]};b.database().ref("/cells").once("value",function(e){try{var t=e.val();for(var o in t){var n=t[o];(n.row>=_.cells.length||!_.cells[n.row])&&_.cells.$set(n.row,[]),_.cells[n.row].$set(n.col,n)}}catch(r){console.error(r),console.error(n)}}),b.database().ref("/cells").on("child_changed",function(e,t){var o=e.val();o.content||(o.content=""),console.log("Before assign:",(new Date).getTime()),p["default"].assign(_.cells[o.row][o.col],o),console.log("After assign:",(new Date).getTime())}),t["default"]=_},,function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(19),a=n(r),l=o(1),s=n(l);t["default"]={data:function(){return{data:s["default"]}},components:{Worksheet:a["default"]}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(13),r=o(1);t["default"]={props:["cell","worksheet"],data:function(){return{focus:!1}},computed:{cellStyle:function(){return{textAlign:isNaN(this.value)?"left":"right",fontWeight:(0,r.isFormula)(this.cell.content)?"bold":"normal",color:(0,r.isFormula)(this.cell.content)?"#000":"auto"}},value:function(){return(0,r.getValue)(this.worksheet,this.cell.row,this.cell.col)}},methods:{onFocus:function(){this.focus=!0},onBlur:function(){this.focus=!1,(0,r.save)(this.cell)}},directives:{focus:n.focus}}},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(18),a=n(r);t["default"]={components:{Cell:a["default"]},props:["data"],data:function(){return this.data},created:function(){},computed:{},methods:{getColName:function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return t[e]},getRowName:function(e){return e+1}}}},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,,,function(e,t){e.exports='<div v-on:click=onFocus v-bind:style=[cellStyle] class=text _v-5e3aac2f="">{{ value }}</div> <input v-focus=focus v-on:blur=onBlur v-show=focus v-el=input type=text v-model=cell.content _v-5e3aac2f="">'},function(e,t){e.exports='<div id=app _v-65b1bda8=""> <h1 _v-65b1bda8="">CF Excel</h1> <p _v-65b1bda8="">This is a test excel-like app. Supported formulas:</p> <ul _v-65b1bda8=""> <li _v-65b1bda8="">= <span class=function-name _v-65b1bda8="">SUM</span><span class=function-arguments _v-65b1bda8="">(X1:Y9)</span></li> <li _v-65b1bda8="">= <span class=function-name _v-65b1bda8="">MIN</span><span class=function-arguments _v-65b1bda8="">(X1:Y9)</span></li> <li _v-65b1bda8="">= <span class=function-name _v-65b1bda8="">MAX</span><span class=function-arguments _v-65b1bda8="">(X1:Y9)</span></li> <li _v-65b1bda8="">= <span class=function-name _v-65b1bda8="">AVERAGE</span><span class=function-arguments _v-65b1bda8="">(X1:Y9)</span></li> </ul> <worksheet :data=data _v-65b1bda8=""></worksheet> </div>'},function(e,t){e.exports='<div class=hello _v-7f89271e=""> <h1 _v-7f89271e="">{{ name }}</h1> </div> <table _v-7f89271e=""> <thead _v-7f89271e=""> <tr _v-7f89271e=""> <th class=col-label _v-7f89271e=""> </th> <th class=col-label v-for="(index, col) in cells[0]" _v-7f89271e=""> {{ getColName(index) }} </th> </tr> </thead> <tbody _v-7f89271e=""> <tr v-for="(index, row) in cells" _v-7f89271e=""> <td class=row-label _v-7f89271e="">{{ getRowName(index) }}</td> <td v-for="cell in row" _v-7f89271e=""> <cell :worksheet=data :cell=cell _v-7f89271e=""></cell> </td> </tr> </tbody> </table>'},function(e,t,o){var n,r;o(6),o(8),n=o(3),r=o(15),e.exports=n||{},e.exports.__esModule&&(e.exports=e.exports["default"]),r&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=r)},function(e,t,o){var n,r;o(7),n=o(4),r=o(14),e.exports=n||{},e.exports.__esModule&&(e.exports=e.exports["default"]),r&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=r)},function(e,t,o){var n,r;o(9),n=o(5),r=o(16),e.exports=n||{},e.exports.__esModule&&(e.exports=e.exports["default"]),r&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=r)}]);
//# sourceMappingURL=app.fc3729829a3668f98837.js.map