{"version":3,"sources":["webpack:///static/js/app.00f9ab690ab4d9f9c5cf.js","webpack:///./src/main.js","webpack:///./src/store.js","webpack:///App.vue","webpack:///Cell.vue","webpack:///Worksheet.vue","webpack:///./src/App.vue?d818","webpack:///./src/components/Cell.vue?eeca","webpack:///./src/components/Worksheet.vue?8892","webpack:///./src/App.vue","webpack:///./src/components/Cell.vue","webpack:///./src/components/Worksheet.vue"],"names":["webpackJsonp","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","_vue","_vue2","_App","_App2","el","components","App","isFormula","content","ex","literalToOffset","cellName","letters","colName","toUpperCase","rowName","substring","row","col","indexOf","getCellsRect","worksheet","start","end","startOffset","endOffset","temp","_temp","cells","push","applyFormula","formula","formulaRegex","tokens","exec","name","params","interval","split","sum","i","length","cell","getValue","max","Number","NEGATIVE_INFINITY","_i","_cell","value","min","POSITIVE_INFINITY","_i2","_cell2","_value","isForm","save","id","ref","db","database","set","Object","defineProperty","_firebase","_firebase2","_lodash","_lodash2","config","apiKey","authDomain","databaseURL","storageBucket","initializeApp","data","once","snapshot","val","cellId","$set","console","log","error","on","childSnapshot","prevChildKey","Date","getTime","assign","_Worksheet","_Worksheet2","_store","_store2","Worksheet","_vueFocus","props","focus","computed","cellStyle","textAlign","isNaN","this","fontWeight","color","methods","onFocus","onBlur","directives","_Cell","_Cell2","Cell","created","getColName","index","getRowName","__vue_script__","__vue_template__","options","template"],"mappings":"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","file":"static/js/app.00f9ab690ab4d9f9c5cf.js","sourcesContent":["webpackJsonp([1,0],[\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _vue = __webpack_require__(2);\n\t\n\tvar _vue2 = _interopRequireDefault(_vue);\n\t\n\tvar _App = __webpack_require__(16);\n\t\n\tvar _App2 = _interopRequireDefault(_App);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tnew _vue2.default({\n\t  el: 'body',\n\t  components: { App: _App2.default }\n\t});\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.isFormula = isFormula;\n\texports.getValue = getValue;\n\texports.save = save;\n\t\n\tvar _firebase = __webpack_require__(9);\n\t\n\tvar _firebase2 = _interopRequireDefault(_firebase);\n\t\n\tvar _lodash = __webpack_require__(11);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar config = {\n\t  apiKey: 'AIzaSyCV75QBr8hleUZ2rQ-uOx1NyE8q2Rn1uXo',\n\t  authDomain: 'cf-excel.firebaseapp.com',\n\t  databaseURL: 'https://cf-excel.firebaseio.com',\n\t  storageBucket: ''\n\t};\n\tvar db = _firebase2.default.initializeApp(config);\n\t\n\tvar data = {\n\t  cells: []\n\t};\n\t\n\tdb.database().ref('/cells').once('value', function (snapshot) {\n\t  try {\n\t    var cells = snapshot.val();\n\t    for (var cellId in cells) {\n\t      var cell = cells[cellId];\n\t      if (cell.row >= data.cells.length || !data.cells[cell.row]) {\n\t        data.cells.$set(cell.row, []);\n\t      }\n\t      data.cells[cell.row].$set(cell.col, cell);\n\t    }\n\t    console.log('completed');\n\t  } catch (ex) {\n\t    console.error(ex);\n\t    console.error(cell);\n\t  }\n\t});\n\t\n\tdb.database().ref('/cells').on('child_changed', function (childSnapshot, prevChildKey) {\n\t  var cell = childSnapshot.val();\n\t  if (!cell.content) {\n\t    cell.content = '';\n\t  }\n\t  console.log('Before assign:', new Date().getTime());\n\t  _lodash2.default.assign(data.cells[cell.row][cell.col], cell);\n\t  console.log('After assign:', new Date().getTime());\n\t});\n\t\n\texports.default = data;\n\tfunction isFormula(content) {\n\t  try {\n\t    return content[0] === '=';\n\t  } catch (ex) {\n\t    return false;\n\t  }\n\t}\n\t\n\tfunction literalToOffset(cellName) {\n\t  var letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n\t  var colName = cellName[0].toUpperCase();\n\t  var rowName = cellName.substring(1);\n\t\n\t  var row = rowName * 1 - 1;\n\t  var col = letters.indexOf(colName);\n\t  return {\n\t    row: row,\n\t    col: col\n\t  };\n\t}\n\t\n\tfunction getCellsRect(worksheet, start, end) {\n\t  var startOffset = literalToOffset(start);\n\t  var endOffset = literalToOffset(end);\n\t  if (startOffset.row > endOffset.row) {\n\t    var temp = startOffset.row;\n\t    startOffset.row = endOffset.row;\n\t    endOffset = temp;\n\t  }\n\t  if (startOffset.col > endOffset.col) {\n\t    var _temp = startOffset.col;\n\t    startOffset.col = endOffset.col;\n\t    endOffset = _temp;\n\t  }\n\t\n\t  var cells = [];\n\t  for (var row = startOffset.row; row <= endOffset.row; row++) {\n\t    for (var col = startOffset.col; col <= endOffset.col; col++) {\n\t      cells.push(worksheet.cells[row][col]);\n\t    }\n\t  }\n\t  return cells;\n\t}\n\t\n\tfunction applyFormula(worksheet, formula) {\n\t  var formulaRegex = /=([^\\(]+)\\(([^\\)]+)\\)/gi;\n\t  var tokens = formulaRegex.exec(formula);\n\t  try {\n\t    var name = tokens[1].toUpperCase();\n\t    var params = tokens[2];\n\t    var interval = params.split(':');\n\t    var cells = getCellsRect(worksheet, interval[0], interval[1]);\n\t\n\t    if (name === 'SUM') {\n\t      var sum = 0;\n\t      for (var i = 0; i < cells.length; i++) {\n\t        var cell = cells[i];\n\t        sum += getValue(worksheet, cell.row, cell.col) * 1;\n\t      }\n\t      return sum;\n\t    }\n\t\n\t    if (name === 'MAX') {\n\t      var max = Number.NEGATIVE_INFINITY;\n\t      for (var _i = 0; _i < cells.length; _i++) {\n\t        var _cell = cells[_i];\n\t        var value = getValue(worksheet, _cell.row, _cell.col) * 1;\n\t        if (value > max) {\n\t          max = value;\n\t        }\n\t      }\n\t      return max;\n\t    }\n\t\n\t    if (name === 'MIN') {\n\t      var min = Number.POSITIVE_INFINITY;\n\t      for (var _i2 = 0; _i2 < cells.length; _i2++) {\n\t        var _cell2 = cells[_i2];\n\t        var _value = getValue(worksheet, _cell2.row, _cell2.col) * 1;\n\t        if (_value < min) {\n\t          min = _value;\n\t        }\n\t      }\n\t      return min;\n\t    }\n\t\n\t    return 'UNDEF';\n\t  } catch (ex) {\n\t    return 'err';\n\t  }\n\t}\n\t\n\tfunction getValue(worksheet, row, col) {\n\t  var content = worksheet.cells[row][col].content;\n\t  var isForm = isFormula(content);\n\t  if (!isForm) {\n\t    return worksheet.cells[row][col].content;\n\t  }\n\t  return applyFormula(worksheet, content);\n\t}\n\t\n\tfunction save(cell) {\n\t  var id = cell.row + '_' + cell.col;\n\t  var ref = '/cells/' + id;\n\t\n\t  db.database().ref(ref).set(cell);\n\t}\n\n/***/ },\n/* 2 */,\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _Worksheet = __webpack_require__(18);\n\t\n\tvar _Worksheet2 = _interopRequireDefault(_Worksheet);\n\t\n\tvar _store = __webpack_require__(1);\n\t\n\tvar _store2 = _interopRequireDefault(_store);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\texports.default = {\n\t  data: function data() {\n\t    return {\n\t      data: _store2.default\n\t    };\n\t  },\n\t\n\t  components: {\n\t    Worksheet: _Worksheet2.default\n\t  }\n\t};\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _vueFocus = __webpack_require__(12);\n\t\n\tvar _store = __webpack_require__(1);\n\t\n\texports.default = {\n\t  props: ['cell', 'worksheet'],\n\t  data: function data() {\n\t    return {\n\t      focus: false\n\t    };\n\t  },\n\t\n\t  computed: {\n\t    cellStyle: function cellStyle() {\n\t      return {\n\t        textAlign: isNaN(this.value) ? 'left' : 'right',\n\t        fontWeight: (0, _store.isFormula)(this.cell.content) ? 'bold' : 'normal',\n\t        color: (0, _store.isFormula)(this.cell.content) ? '#000' : 'auto'\n\t      };\n\t    },\n\t    value: function value() {\n\t      return (0, _store.getValue)(this.worksheet, this.cell.row, this.cell.col);\n\t    }\n\t  },\n\t  methods: {\n\t    onFocus: function onFocus() {\n\t      this.focus = true;\n\t    },\n\t    onBlur: function onBlur() {\n\t      this.focus = false;\n\t      (0, _store.save)(this.cell);\n\t    }\n\t  },\n\t  directives: { focus: _vueFocus.focus }\n\t};\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _Cell = __webpack_require__(17);\n\t\n\tvar _Cell2 = _interopRequireDefault(_Cell);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\texports.default = {\n\t  components: {\n\t    Cell: _Cell2.default\n\t  },\n\t  props: ['data'],\n\t  data: function data() {\n\t    return this.data;\n\t  },\n\t\n\t  created: function created() {},\n\t  computed: {},\n\t  methods: {\n\t    getColName: function getColName(index) {\n\t      var letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n\t      return letters[index];\n\t    },\n\t    getRowName: function getRowName(index) {\n\t      return index + 1;\n\t    }\n\t  }\n\t};\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ },\n/* 9 */,\n/* 10 */,\n/* 11 */,\n/* 12 */,\n/* 13 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div id=app> <h1>CF Excel</h1> <p>This is a test excel-like app. Supported formulas:</p> <ul> <li>= SUM(B5:C6)</li> <li>= MIN(B5:C6)</li> <li>= MAX(B5:C6)</li> </ul> <worksheet :data=data></worksheet> </div>\";\n\n/***/ },\n/* 14 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div v-on:click=onFocus v-bind:style=[cellStyle] class=text _v-5e3aac2f=\\\"\\\">{{ value }}</div> <input v-focus=focus v-on:blur=onBlur v-show=focus v-el=input type=text v-model=cell.content _v-5e3aac2f=\\\"\\\">\";\n\n/***/ },\n/* 15 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=hello _v-7f89271e=\\\"\\\"> <h1 _v-7f89271e=\\\"\\\">{{ name }}</h1> </div> <table _v-7f89271e=\\\"\\\"> <thead _v-7f89271e=\\\"\\\"> <tr _v-7f89271e=\\\"\\\"> <th class=col-label _v-7f89271e=\\\"\\\"> </th> <th class=col-label v-for=\\\"(index, col) in cells[0]\\\" _v-7f89271e=\\\"\\\"> {{ getColName(index) }} </th> </tr> </thead> <tbody _v-7f89271e=\\\"\\\"> <tr v-for=\\\"(index, row) in cells\\\" _v-7f89271e=\\\"\\\"> <td class=row-label _v-7f89271e=\\\"\\\">{{ getRowName(index) }}</td> <td v-for=\\\"cell in row\\\" _v-7f89271e=\\\"\\\"> <cell :worksheet=data :cell=cell _v-7f89271e=\\\"\\\"></cell> </td> </tr> </tbody> </table>\";\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __vue_script__, __vue_template__\n\t__webpack_require__(6)\n\t__vue_script__ = __webpack_require__(3)\n\t__vue_template__ = __webpack_require__(13)\n\tmodule.exports = __vue_script__ || {}\n\tif (module.exports.__esModule) module.exports = module.exports.default\n\tif (__vue_template__) {\n\t(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n\t}\n\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __vue_script__, __vue_template__\n\t__webpack_require__(7)\n\t__vue_script__ = __webpack_require__(4)\n\t__vue_template__ = __webpack_require__(14)\n\tmodule.exports = __vue_script__ || {}\n\tif (module.exports.__esModule) module.exports = module.exports.default\n\tif (__vue_template__) {\n\t(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n\t}\n\n\n/***/ },\n/* 18 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __vue_script__, __vue_template__\n\t__webpack_require__(8)\n\t__vue_script__ = __webpack_require__(5)\n\t__vue_template__ = __webpack_require__(15)\n\tmodule.exports = __vue_script__ || {}\n\tif (module.exports.__esModule) module.exports = module.exports.default\n\tif (__vue_template__) {\n\t(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n\t}\n\n\n/***/ }\n]);\n\n\n/** WEBPACK FOOTER **\n ** static/js/app.00f9ab690ab4d9f9c5cf.js\n **/","import Vue from 'vue'\r\nimport App from './App'\r\n\r\n/* eslint-disable no-new */\r\nnew Vue({\r\n  el: 'body',\r\n  components: { App }\r\n})\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/main.js\n **/","import firebase from 'firebase'\nimport _ from 'lodash'\n\nvar config = {\n  apiKey: 'AIzaSyCV75QBr8hleUZ2rQ-uOx1NyE8q2Rn1uXo',\n  authDomain: 'cf-excel.firebaseapp.com',\n  databaseURL: 'https://cf-excel.firebaseio.com',\n  storageBucket: ''\n}\nvar db = firebase.initializeApp(config)\n\nvar data = {\n  cells: []\n}\n\n// var rowsNumber = 100\n// var colsNumber = 20\n\n// for (var row = 0; row < rowsNumber; row++) {\n//   data.cells[row] = []\n//   for (var col = 0; col < colsNumber; col++) {\n//     let cell = {\n//       row,\n//       col,\n//       content: ((col === 1) ? Math.round(Math.random() * 100) : '')\n//     }\n//     save(cell)\n//     data.cells[row][col] = cell\n//   }\n// }\n\ndb.database().ref('/cells').once('value', function (snapshot) {\n  try {\n    var cells = snapshot.val()\n    for (let cellId in cells) {\n      var cell = cells[cellId]\n      if ((cell.row >= data.cells.length) || (!data.cells[cell.row])) {\n        data.cells.$set(cell.row, [])\n      }\n      data.cells[cell.row].$set(cell.col, cell)\n    }\n    console.log('completed')\n  } catch (ex) {\n    console.error(ex)\n    console.error(cell)\n  }\n})\n\ndb.database().ref('/cells').on('child_changed', function (childSnapshot, prevChildKey) {\n  var cell = childSnapshot.val()\n  if (!cell.content) {\n    cell.content = ''\n  }\n  console.log('Before assign:', (new Date()).getTime())\n  _.assign(data.cells[cell.row][cell.col], cell)\n  console.log('After assign:', (new Date()).getTime())\n})\n\n// Generate the data\n// data.rows = []\n\n// var rowsNumber = 100\n// var colsNumber = 20\n\n// for (var row = 0; row < rowsNumber; row++) {\n//   data.rows[row] = []\n//   for (var col = 0; col < colsNumber; col++) {\n//     data.rows[row][col] = {\n//       row,\n//       col,\n//       content: ((col === 1) ? Math.round(Math.random() * 100) : null)\n//     }\n//   }\n// }\n\nexport default data\n\nexport function isFormula (content) {\n  try {\n    return (content[0] === '=')\n  } catch (ex) {\n    return false\n  }\n}\n\nfunction literalToOffset (cellName) {\n  var letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n  var colName = cellName[0].toUpperCase()\n  var rowName = cellName.substring(1)\n\n  var row = (rowName * 1) - 1\n  var col = letters.indexOf(colName)\n  return {\n    row,\n    col\n  }\n}\n\nfunction getCellsRect (worksheet, start, end) {\n  var startOffset = literalToOffset(start)\n  var endOffset = literalToOffset(end)\n  if (startOffset.row > endOffset.row) {\n    let temp = startOffset.row\n    startOffset.row = endOffset.row\n    endOffset = temp\n  }\n  if (startOffset.col > endOffset.col) {\n    let temp = startOffset.col\n    startOffset.col = endOffset.col\n    endOffset = temp\n  }\n\n  var cells = []\n  for (var row = startOffset.row; row <= endOffset.row; row++) {\n    for (var col = startOffset.col; col <= endOffset.col; col++) {\n      cells.push(worksheet.cells[row][col])\n    }\n  }\n  return cells\n}\n\nfunction applyFormula (worksheet, formula) {\n  var formulaRegex = /=([^\\(]+)\\(([^\\)]+)\\)/gi\n  var tokens = formulaRegex.exec(formula)\n  try {\n    var name = tokens[1].toUpperCase()\n    var params = tokens[2]\n    var interval = params.split(':')\n    var cells = getCellsRect(worksheet, interval[0], interval[1])\n\n    if (name === 'SUM') {\n      let sum = 0\n      for (let i = 0; i < cells.length; i++) {\n        let cell = cells[i]\n        sum += (getValue(worksheet, cell.row, cell.col) * 1)\n      }\n      return sum\n    }\n\n    if (name === 'MAX') {\n      let max = Number.NEGATIVE_INFINITY\n      for (let i = 0; i < cells.length; i++) {\n        let cell = cells[i]\n        let value = getValue(worksheet, cell.row, cell.col) * 1\n        if (value > max) {\n          max = value\n        }\n      }\n      return max\n    }\n\n    if (name === 'MIN') {\n      let min = Number.POSITIVE_INFINITY\n      for (let i = 0; i < cells.length; i++) {\n        let cell = cells[i]\n        let value = getValue(worksheet, cell.row, cell.col) * 1\n        if (value < min) {\n          min = value\n        }\n      }\n      return min\n    }\n\n    return 'UNDEF'\n  } catch (ex) {\n    return 'err'\n  }\n}\n\nexport function getValue (worksheet, row, col) {\n  // if (row === 3 && col === 4) {\n  //   var sum = 0\n  //   for (var i = 0; i < worksheet.cells.length; i++) {\n  //     sum += (getValue(worksheet, i, 1) * 1)\n  //   }\n  //   return sum\n  // }\n  var content = worksheet.cells[row][col].content\n  var isForm = isFormula(content)\n  if (!isForm) {\n    return worksheet.cells[row][col].content\n  }\n  return applyFormula(worksheet, content)\n  // compute the formula\n}\n\n// export compute(worksheet) {\n//   var rowsNumber = worksheet.cells.length\n//   var colsNumber = worksheet.cols.length\n//   for (var row = 0; row < rowsNumber; row++) {\n//     for (var col = 0; col < colsNumber; col++) {\n//       worksheet[row][col].value = getValue(worksheet, row, col);\n//     }\n//   }\n// }\n\n// db.database().ref('/').set(data)\n\nexport function save (cell) {\n  var id = cell.row + '_' + cell.col\n  var ref = '/cells/' + id\n  // console.log('Saving to ' + ref, cell)\n  db.database().ref(ref).set(cell)\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/store.js\n **/","<template>\r\n  <div id=\"app\">\r\n    <h1>CF Excel</h1>\r\n    <p>This is a test excel-like app. Supported formulas:</p>\r\n    <ul>\r\n      <li>= SUM(B5:C6)</li>\r\n      <li>= MIN(B5:C6)</li>\r\n      <li>= MAX(B5:C6)</li>\r\n    </ul>\r\n    <worksheet :data=\"data\"></worksheet>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Worksheet from './components/Worksheet'\r\nimport Store from './store'\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      data: Store\r\n    }\r\n  },\r\n  components: {\r\n    Worksheet\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\nhtml {\r\n  font-family: 'Lato';\r\n  max-width: 1024px;\r\n  margin: 10px auto;\r\n  color: #999;\r\n}\r\n\r\nh1 {\r\n  font-size: 32px;\r\n  color: #555;\r\n  font-weight: normal;\r\n  margin: 1.5em 0 .5em;\r\n}\r\n\r\nul {\r\n  padding: 0;\r\n  line-height: 1.5em;\r\n  font-family: 'Inconsolata';\r\n  letter-spacing: 1px;\r\n}\r\n\r\n.logo {\r\n  width: 100px;\r\n  height: 100px\r\n}\r\n</style>\r\n\n\n\n/** WEBPACK FOOTER **\n ** App.vue?d4e1d448\n **/","<template>\r\n  <div v-on:click=\"onFocus\" v-bind:style=\"[cellStyle]\" class=\"text\">{{ value }}</div>\r\n  <input v-focus=\"focus\" v-on:blur=\"onBlur\" v-show=\"focus\" v-el=\"input\" type=\"text\" v-model=\"cell.content\">\r\n</template>\r\n\r\n<script>\r\nimport { focus } from 'vue-focus'\r\nimport { getValue, save, isFormula } from '../store'\r\n\r\nexport default {\r\n  props: ['cell', 'worksheet'],\r\n  data () {\r\n    return {\r\n      focus: false\r\n    }\r\n  },\r\n  computed: {\r\n    cellStyle () {\r\n      return {\r\n        textAlign: (isNaN(this.value)) ? 'left' : 'right',\r\n        fontWeight: (isFormula(this.cell.content)) ? 'bold' : 'normal',\r\n        color: (isFormula(this.cell.content)) ? '#000' : 'auto'\r\n      }\r\n    },\r\n    value () {\r\n      // console.log(this.worksheet)\r\n      // return 1\r\n      return getValue(this.worksheet, this.cell.row, this.cell.col)\r\n    }\r\n  },\r\n  methods: {\r\n    onFocus () {\r\n      this.focus = true\r\n      // console.log(this)\r\n      // this.$$.input.focus()\r\n    },\r\n    onBlur () {\r\n      this.focus = false\r\n      save(this.cell)\r\n      // compute(this.worksheet)\r\n    }\r\n  },\r\n  directives: { focus: focus }\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n.text,\r\ninput {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  border: 1px solid #fafafa;\r\n  outline: none;\r\n  font-size: 12px;\r\n  line-height: 24px;\r\n  z-index: 1;\r\n  overflow: hidden;\r\n}\r\n\r\n.text:hover {\r\n  background-color: #fafafa;\r\n  cursor: text;\r\n}\r\n\r\ninput {\r\n  z-index: 999;\r\n  border-color: #C0E8BB;\r\n  background-color: #fafafa;\r\n  padding-left: 4px;\r\n}\r\n</style>\r\n\n\n\n/** WEBPACK FOOTER **\n ** Cell.vue?157a1ef6\n **/","<template>\r\n  <div class=\"hello\">\r\n    <h1>{{ name }}</h1>\r\n  </div>\r\n  <table>\r\n    <thead>\r\n      <tr>\r\n        <th class=\"col-label\">\r\n          <!-- First empty cell -->\r\n        </th>\r\n        <th class=\"col-label\" v-for=\"(index, col) in cells[0]\">\r\n          {{ getColName(index) }}\r\n        </th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr v-for=\"(index, row) in cells\">\r\n        <td class=\"row-label\">{{ getRowName(index) }}</td>\r\n        <td v-for=\"cell in row\">\r\n          <cell :worksheet=\"data\" :cell=\"cell\"></cell>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</template>\r\n\r\n<script>\r\nimport Cell from './Cell'\r\n\r\nexport default {\r\n  components: {\r\n    Cell\r\n  },\r\n  props: ['data'],\r\n  data () {\r\n    // I dati della worksheet sono quelli passati a questo componente\r\n    return this.data\r\n  },\r\n  created: function () {\r\n    // Crea le celle\r\n  },\r\n  computed: {\r\n\r\n  },\r\n  methods: {\r\n    getColName (index) {\r\n      var letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'\r\n      return letters[index]\r\n    },\r\n    getRowName (index) {\r\n      return (index + 1)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\ntable {\r\n  width: 100%;\r\n  table-layout: fixed;\r\n}\r\n\r\ntable td {\r\n  position: relative;\r\n  padding: 4px;\r\n  font-size: 12px;\r\n  vertical-align: middle;\r\n}\r\n\r\n.row-label,\r\n.col-label {\r\n  background-color: #efefef;\r\n  color: #888;\r\n  font-size: 12px;\r\n  font-weight: normal;\r\n}\r\n\r\n.row-label {\r\n  text-align: right;\r\n}\r\n</style>\r\n\n\n\n/** WEBPACK FOOTER **\n ** Worksheet.vue?5c6f9d52\n **/","module.exports = \"<div id=app> <h1>CF Excel</h1> <p>This is a test excel-like app. Supported formulas:</p> <ul> <li>= SUM(B5:C6)</li> <li>= MIN(B5:C6)</li> <li>= MAX(B5:C6)</li> </ul> <worksheet :data=data></worksheet> </div>\";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/vue-html-loader!./~/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n ** module id = 13\n ** module chunks = 1\n **/","module.exports = \"<div v-on:click=onFocus v-bind:style=[cellStyle] class=text _v-5e3aac2f=\\\"\\\">{{ value }}</div> <input v-focus=focus v-on:blur=onBlur v-show=focus v-el=input type=text v-model=cell.content _v-5e3aac2f=\\\"\\\">\";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/vue-html-loader!./~/vue-loader/lib/template-rewriter.js?id=_v-5e3aac2f!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Cell.vue\n ** module id = 14\n ** module chunks = 1\n **/","module.exports = \"<div class=hello _v-7f89271e=\\\"\\\"> <h1 _v-7f89271e=\\\"\\\">{{ name }}</h1> </div> <table _v-7f89271e=\\\"\\\"> <thead _v-7f89271e=\\\"\\\"> <tr _v-7f89271e=\\\"\\\"> <th class=col-label _v-7f89271e=\\\"\\\"> </th> <th class=col-label v-for=\\\"(index, col) in cells[0]\\\" _v-7f89271e=\\\"\\\"> {{ getColName(index) }} </th> </tr> </thead> <tbody _v-7f89271e=\\\"\\\"> <tr v-for=\\\"(index, row) in cells\\\" _v-7f89271e=\\\"\\\"> <td class=row-label _v-7f89271e=\\\"\\\">{{ getRowName(index) }}</td> <td v-for=\\\"cell in row\\\" _v-7f89271e=\\\"\\\"> <cell :worksheet=data :cell=cell _v-7f89271e=\\\"\\\"></cell> </td> </tr> </tbody> </table>\";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/vue-html-loader!./~/vue-loader/lib/template-rewriter.js?id=_v-7f89271e!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Worksheet.vue\n ** module id = 15\n ** module chunks = 1\n **/","var __vue_script__, __vue_template__\nrequire(\"!!./../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!./../node_modules/vue-loader/lib/style-rewriter.js!./../node_modules/vue-loader/lib/selector.js?type=style&index=0!./App.vue\")\n__vue_script__ = require(\"!!babel-loader?presets[]=es2015&plugins[]=transform-runtime&comments=false!./../node_modules/vue-loader/lib/selector.js?type=script&index=0!./App.vue\")\n__vue_template__ = require(\"!!vue-html-loader!./../node_modules/vue-loader/lib/selector.js?type=template&index=0!./App.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/App.vue\n ** module id = 16\n ** module chunks = 1\n **/","var __vue_script__, __vue_template__\nrequire(\"!!./../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-5e3aac2f&scoped=true!./../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./Cell.vue\")\n__vue_script__ = require(\"!!babel-loader?presets[]=es2015&plugins[]=transform-runtime&comments=false!./../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./Cell.vue\")\n__vue_template__ = require(\"!!vue-html-loader!./../../node_modules/vue-loader/lib/template-rewriter.js?id=_v-5e3aac2f!./../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./Cell.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/components/Cell.vue\n ** module id = 17\n ** module chunks = 1\n **/","var __vue_script__, __vue_template__\nrequire(\"!!./../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-7f89271e&scoped=true!./../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./Worksheet.vue\")\n__vue_script__ = require(\"!!babel-loader?presets[]=es2015&plugins[]=transform-runtime&comments=false!./../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./Worksheet.vue\")\n__vue_template__ = require(\"!!vue-html-loader!./../../node_modules/vue-loader/lib/template-rewriter.js?id=_v-7f89271e!./../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./Worksheet.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/components/Worksheet.vue\n ** module id = 18\n ** module chunks = 1\n **/"],"sourceRoot":""}