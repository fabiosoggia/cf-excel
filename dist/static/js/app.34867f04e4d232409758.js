webpackJsonp([1,0],[function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var r=o(2),l=n(r),s=o(17),c=n(s);new l["default"]({el:"body",components:{App:c["default"]}})},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function r(e){return"string"!=typeof e?!1:0===e.length?!1:"="===e[0]}function l(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",o=e[0].toUpperCase(),n=e.substring(1),r=1*n-1,l=t.indexOf(o);return{row:r,col:l}}function s(e,t,o){var n=l(t),r=l(o);if(n.row>r.row){var s=n.row;n.row=r.row,r=s}if(n.col>r.col){var c=n.col;n.col=r.col,r=c}for(var a=[],u=n.row;u<=r.row;u++)for(var i=n.col;i<=r.col;i++)a.push(e.cells[u][i]);return a}function c(e,t){var o=/=([^\(]+)\(([^\)]+)\)/gi,n=o.exec(t);try{var r=n[1].toUpperCase(),l=n[2],c=l.split(":"),u=s(e,c[0],c[1]),i=u.length;if("SUM"===r){for(var f=0,p=0;i>p;p++){var v=u[p];f+=1*a(e,v.row,v.col)}return f}if("MAX"===r){for(var d=Number.NEGATIVE_INFINITY,_=0;i>_;_++){var h=u[_],x=1*a(e,h.row,h.col);x>d&&(d=x)}return d}if("MIN"===r){for(var m=Number.POSITIVE_INFINITY,w=0;i>w;w++){var g=u[w],b=1*a(e,g.row,g.col);m>b&&(m=b)}return m}if("AVERAGE"===r){for(var y=0,M=0;i>M;M++){var N=u[M];y+=1*a(e,N.row,N.col)}var A=y/i;return A}return"UNDEF"}catch(I){return"err"}}function a(e,t,o){var n=e.cells[t][o].content,l=r(n);return l?c(e,n):e.cells[t][o].content}function u(e){var t=e.row+"_"+e.col,o="/cells/"+t;_.database().ref(o).set(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isFormula=r,t.getValue=a,t.save=u;var i=o(10),f=n(i),p=o(12),v=n(p),d={apiKey:"AIzaSyCV75QBr8hleUZ2rQ-uOx1NyE8q2Rn1uXo",authDomain:"cf-excel.firebaseapp.com",databaseURL:"https://cf-excel.firebaseio.com",storageBucket:""},_=f["default"].initializeApp(d),h={cells:[]};_.database().ref("/cells").once("value",function(e){try{var t=e.val();for(var o in t){var n=t[o];(n.row>=h.cells.length||!h.cells[n.row])&&h.cells.$set(n.row,[]),h.cells[n.row].$set(n.col,n)}}catch(r){console.error(r),console.error(n)}}),_.database().ref("/cells").on("child_changed",function(e,t){var o=e.val();o.content||(o.content=""),console.log("Before assign:",(new Date).getTime()),v["default"].assign(h.cells[o.row][o.col],o),console.log("After assign:",(new Date).getTime())}),t["default"]=h},,function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(19),l=n(r),s=o(1),c=n(s);t["default"]={data:function(){return{data:c["default"]}},components:{Worksheet:l["default"]}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(13),r=o(1);t["default"]={props:["cell","worksheet"],data:function(){return{focus:!1}},computed:{cellStyle:function(){return{textAlign:isNaN(this.value)?"left":"right",fontWeight:(0,r.isFormula)(this.cell.content)?"bold":"normal",color:(0,r.isFormula)(this.cell.content)?"#000":"auto"}},value:function(){return(0,r.getValue)(this.worksheet,this.cell.row,this.cell.col)}},methods:{onFocus:function(){this.focus=!0},onBlur:function(){this.focus=!1,(0,r.save)(this.cell)}},directives:{focus:n.focus}}},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(18),l=n(r);t["default"]={components:{Cell:l["default"]},props:["data"],data:function(){return this.data},created:function(){},computed:{},methods:{getColName:function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return t[e]},getRowName:function(e){return e+1}}}},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,,,function(e,t){e.exports='<div id=app _v-105638c1=""> <h1 _v-105638c1="">CF Excel</h1> <p _v-105638c1="">This is a test excel-like app. Supported formulas:</p> <ul _v-105638c1=""> <li _v-105638c1="">= <span class=function-name _v-105638c1="">SUM</span><span class=function-arguments _v-105638c1="">(X1:Y9)</span></li> <li _v-105638c1="">= <span class=function-name _v-105638c1="">MIN</span><span class=function-arguments _v-105638c1="">(X1:Y9)</span></li> <li _v-105638c1="">= <span class=function-name _v-105638c1="">MAX</span><span class=function-arguments _v-105638c1="">(X1:Y9)</span></li> <li _v-105638c1="">= <span class=function-name _v-105638c1="">AVERAGE</span><span class=function-arguments _v-105638c1="">(X1:Y9)</span></li> </ul> <worksheet :data=data _v-105638c1=""></worksheet> </div>'},function(e,t){e.exports='<div v-on:click=onFocus v-bind:style=[cellStyle] class=text _v-61c2c69b="">{{ value }}</div> <input v-focus=focus v-on:blur=onBlur v-show=focus v-el=input type=text v-model=cell.content _v-61c2c69b="">'},function(e,t){e.exports='<div class=hello _v-700214f6=""> <h1 _v-700214f6="">{{ name }}</h1> </div> <table _v-700214f6=""> <thead _v-700214f6=""> <tr _v-700214f6=""> <th class=col-label _v-700214f6=""> </th> <th class=col-label v-for="(index, col) in cells[0]" _v-700214f6=""> {{ getColName(index) }} </th> </tr> </thead> <tbody _v-700214f6=""> <tr v-for="(index, row) in cells" _v-700214f6=""> <td class=row-label _v-700214f6="">{{ getRowName(index) }}</td> <td v-for="cell in row" _v-700214f6=""> <cell :worksheet=data :cell=cell _v-700214f6=""></cell> </td> </tr> </tbody> </table>'},function(e,t,o){var n,r;o(6),o(7),n=o(3),r=o(14),e.exports=n||{},e.exports.__esModule&&(e.exports=e.exports["default"]),r&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=r)},function(e,t,o){var n,r;o(8),n=o(4),r=o(15),e.exports=n||{},e.exports.__esModule&&(e.exports=e.exports["default"]),r&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=r)},function(e,t,o){var n,r;o(9),n=o(5),r=o(16),e.exports=n||{},e.exports.__esModule&&(e.exports=e.exports["default"]),r&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=r)}]);
//# sourceMappingURL=app.34867f04e4d232409758.js.map